<?xml version="1.0"?>
<!DOCTYPE moduleset SYSTEM "moduleset.dtd">
<?xml-stylesheet type="text/xsl" href="moduleset.xsl"?>
<moduleset>
  <repository type="git" name="git.gnome.org" default="yes"
              href="git://git.gnome.org/"/>
  <repository type="git" name="github" href="git://github.com/"/>
  <repository type="git" name="freedesktop"
              href="git://anongit.freedesktop.org/git/"/>
  <repository type="tarball" name="ragel"
              href="http://www.colm.net/wp-content/uploads/2014/10/"/>

  <!-- This module set works a bit differently than for example the
       GNOME ones do. It's split up in seperate pieces:

       - gtk-osx-bootstrap: contains bootstrap-like modules that you
         don't want to rebuild all the time.

       - gtk-osx.modules: contains the core GTK+ stack. This does not
         have a hard dependency on the bootstrap modules, in order to
         make it easy to rebuild the whole core stack without redoing
         the bootstrap parts. They have a soft, "after", depencency.

       The remaining modules are mostly for testing and might not work
       all the time:

       - gtk-osx-python.modules: self explaining.
       - gtk-osx-gtkmm.modules: self explaining.
       - gtk-osx-javascript.modules: GJS, associated tools, and the Mozilla JS
         library it depends on.
       - gtk-osx-gstreamer.modules: self explaining.
       - gtk-osx-themes.modules: self explaining.
       - gtk-osx-webkit.modules: Various configurations of WebKit, and the
         libsoup/crypto stack it depends on.

       - gtk-osx-random.modules: "random stuff", has apps for testing GTK+.
       - gtk-osx-unsupported.modules: more testing stuff, competely unsupported.
  -->

  <include href="gtk-osx-bootstrap.modules"/>
  <include href="gtk-osx-python.modules"/>
  <include href="gtk-osx-gstreamer.modules"/>
  <include href="gtk-osx-gtkmm.modules"/>
  <include href="gtk-osx-javascript.modules"/>
  <include href="gtk-osx-themes.modules"/>
  <include href="gtk-osx-random.modules"/>
  <include href="gtk-osx-unsupported.modules"/>
  <include href="gtk-osx-universal.modules"/>
  <include href="gtk-osx-webkit.modules"/>

  <metamodule id="meta-gtk-osx-core">
    <dependencies>
      <dep package="gtk+"/>
      <dep package="gtk-mac-integration"/>
    </dependencies>
    <after>
      <dep package="meta-gtk-osx-bootstrap"/>
    </after>
  </metamodule>

  <metamodule id="meta-gtk-osx-gtk3">
    <dependencies>
      <dep package="gtk+-3.0"/>
      <dep package="gtk-mac-integration"/>
      <dep package="meta-gtk-osx-gtk3-core-themes"/>
    </dependencies>
    <after>
      <dep package="meta-gtk-osx-bootstrap"/>
    </after>
  </metamodule>

  <autotools id="glib">
    <branch tag="glib-2-44"/>
    <dependencies>
      <dep package="libffi"/>
    </dependencies>
    <after>
      <dep package="meta-gtk-osx-bootstrap"/>
    </after>
  </autotools>

  <autotools id="libffi" autogenargs="--disable-builddir">
    <branch module="atgreen/libffi" repo="github" tag="v3.2.1"/>
  </autotools>

  <autotools id="xorg-util-macros">
    <branch repo="freedesktop" module="xorg/util/macros"
            tag="util-macros-1.19.0"/>
  </autotools>

  <!-- There is no stable release yet that works here, so use master -->
  <autotools id="libepoxy">
    <branch repo="github" module="anholt/libepoxy"/>
    <dependencies>
      <dep package="xorg-util-macros"/>
    </dependencies>
  </autotools>

  <autotools id="gobject-introspection-10">
    <branch tag="GOBJECT_INTROSPECTION_0_10_1"/>
    <dependencies>
      <dep package="glib"/>
      <dep package="cairo"/>
      <dep package="libffi"/>
    </dependencies>
  </autotools>

  <autotools id="gobject-introspection">
    <branch tag="gnome-3-16" module="gobject-introspection"/>
    <dependencies>
      <dep package="glib"/>
      <dep package="cairo"/>
    </dependencies>
    <after>
      <dep package='python'/>
    </after>
  </autotools>

  <autotools id="pango">
    <branch tag="pango-1-36"/>
    <dependencies>
      <dep package="glib"/>
      <dep package="cairo"/>
    </dependencies>
    <after>
      <dep package="gobject-introspection"/>
      <dep package="meta-gtk-osx-freetype"/>
      <dep package="gobject-introspection-10"/>
      <dep package="meta-gtk-osx-bootstrap"/>
    </after>
  </autotools>

  <autotools id="atk">
    <branch tag="gnome-3-16"/>
    <dependencies>
      <dep package="glib"/>
    </dependencies>
    <after>
      <dep package="meta-gtk-osx-bootstrap"/>
      <dep package="gobject-introspection"/>
      <dep package="gobject-introspection-10"/>
    </after>
  </autotools>

  <autotools id="gdk-pixbuf">
<!--gdk-pixbuf is releasing from master-->
    <branch />
    <after>
      <dep package="pango"/>
      <dep package="gobject-introspection"/>
      <dep package="gobject-introspection-10"/>
    </after>
  </autotools>


  <autotools id="gtk+" autogenargs="--with-gdktarget=quartz --enable-introspection=no --enable-quartz-relocation">
    <branch revision="gtk-2-24"/>
    <dependencies>
      <dep package="pango"/>
      <dep package="atk"/>
      <dep package="gdk-pixbuf"/>
    </dependencies>
    <after>
      <dep package="meta-gtk-osx-bootstrap"/>
      <dep package="gobject-introspection-10"/>
    </after>
  </autotools>

  <autotools id="gtk+-3.0"
	     autogenargs="--enable-quartz-backend --disable-colord  --enable-quartz-relocation">
    <branch module="gtk+" checkoutdir="gtk+-3.0" revision="gtk-3-16"/>
    <dependencies>
      <dep package="glib"/>
      <dep package="pango"/>
      <dep package="atk"/>
      <dep package="gdk-pixbuf"/>
      <dep package="gobject-introspection"/>
      <dep package="libepoxy"/>
    </dependencies>
    <after>
      <dep package="meta-gtk-osx-bootstrap"/>
    </after>
  </autotools>

  <autotools id="pixman" autogenargs="--disable-gtk --disable-mmx">
    <branch repo="freedesktop" module="pixman" tag="0.32"/>
    <after>
      <dep package="meta-gtk-osx-bootstrap"/>
    </after>
  </autotools>

  <!-- enable-fc and enable-ft required for librsvg's pixbuf loader -->
  <autotools id="cairo"
             autogenargs="--enable-pdf --enable-quartz --enable-fc --enable-ft --disable-xlib --without-x">
    <branch repo="freedesktop" module="cairo" revision="1.14"/>
    <dependencies>
      <dep package="pixman"/>
      <dep package="fontconfig"/>
      <dep package="freetype"/>
    </dependencies>
    <after>
      <dep package="meta-gtk-osx-bootstrap"/>
    </after>
  </autotools>

  <!-- Ragel, like Vala, isn't bootstrappable from git, so we might as well just use the tarball. -->
  <autotools id="ragel" autogen-sh='autoreconf'>
    <branch repo="ragel" module="ragel-6.9.tar.gz" version="6.9">
      <patch file="http://git.gnome.org/browse/gtk-osx/plain/patches/ragel-6.9-setiosflags.patch" strip="1"/>
    </branch>
  </autotools>

  <autotools id="gtk-mac-integration" autogenargs="--disable-python">
<!--gtk-mac-integration releases from master"-->
    <branch />
    <dependencies>
    </dependencies>
    <after>
      <dep package="gtk+"/>
      <dep package="gtk+-3.0"/>
      <dep package="meta-gtk-osx-bootstrap"/>
    </after>
  </autotools>

</moduleset>
